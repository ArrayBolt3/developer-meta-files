== anon-apt-sources-list ==

* https://github.com/Whonix/anon-apt-sources-list
* [https://github.com/Whonix/anon-apt-sources-list/blob/master/debian/control debian/control]
===  /etc/apt/sources.list.d/debian.list for Anonymity Linux Distributions ===

A question of distribution maintenance strategies. The more standard
way would indeed be populating /etc/apt/sources.list at install or build time
and leaving /etc/apt/sources.list.d alone. The idea of managing
/etc/apt/sources.list.d/debian.list for the user is, the anonymity
distribution maintainers can decide when it is a better "change stable to
oldstable", "keep wheezy as long as needed to work out [eventual!] issues
that would break during upgrade to jessie" and such.
=== /etc/apt/sources.list.d/debian.list ===

* [https://github.com/Whonix/anon-apt-sources-list/blob/master/etc/apt/sources.list.d/debian.list /etc/apt/sources.list.d/debian.list]
* <code>~/Whonix/packages/anon-apt-sources-list/etc/apt/sources.list.d/debian.list</code>

Debian APT repository sources.list

Configured to use <code>tor+https</code>.

Technical notes:
- Why is buster-updates disabled by default?
  See: https://wiki.debian.org/StableUpdates
- Why are sources (deb-src) disabled by default?
  Because those are not required by most users, to save time while
  running <code>sudo apt update</code>.
- See also: https://www.debian.org/security/
- See also: <code>/etc/apt/sources.list.d/</code>
== anon-base-files ==

* https://github.com/Whonix/anon-base-files
* [https://github.com/Whonix/anon-base-files/blob/master/debian/control debian/control]
===  base files for Anonymity Distributions ===

Creates user "user" with password "changeme" (not in Qubes).
That is if user "user" is not existing yet.
And if it does create "user" user it also locks the root account.
Therefore root account locking effectively only happens in new
builds not having user "user" already created.

Adds user "user" to groups "cdrom,audio,dip,sudo,plugdev".

Creates version file /var/lib/anon-dist/build_version.

Anonymized operating system user name "user", /etc/hostname, /etc/hosts,
/etc/machine-id, /var/lib/dbus/machine-id, which should be shared among all
anonymity distributions. See also:

* https://mailman.boum.org/pipermail/tails-dev/2013-January/002457.html
* https://labs.riseup.net/code/issues/5655
* http://lists.autistici.org/message/20140627.215105.24023267.en.html

Ships a systemd unit file anon-base-files-skel-first-boot.service
which runs /usr/lib/helper-scripts/first-boot-skel (part of helper-scripts)
package.

This package gets installed by default in both, Kicksecure and Whonix.
=== /etc/hosts.anondist ===

* [https://github.com/Whonix/anon-base-files/blob/master/etc/hosts.anondist /etc/hosts.anondist]
* <code>~/Whonix/packages/anon-base-files/etc/hosts.anondist</code>

Debian default /etc/hosts + Anonymity Distribution specific additions.

Currently only <code>127.0.0.1 host.localdomain host</code> gets added.
== anon-shared-build-apt-sources-tpo ==

* https://github.com/Whonix/anon-shared-build-apt-sources-tpo
* [https://github.com/Whonix/anon-shared-build-apt-sources-tpo/blob/master/debian/control debian/control]
===  Adds TPO's APT repository to Anonymity Linux Distributions ===

Comes with "deb http://deb.torproject.org/torproject.org stable main", The Tor
Project's APT signing key.

This package is produced independently of, and carries no guarantee from,
The Tor Project.
=== /etc/apt/sources.list.d/torproject.list ===

* [https://github.com/Whonix/anon-shared-build-apt-sources-tpo/blob/master/etc/apt/sources.list.d/torproject.list /etc/apt/sources.list.d/torproject.list]
* <code>~/Whonix/packages/anon-shared-build-apt-sources-tpo/etc/apt/sources.list.d/torproject.list</code>
* Not installed by default.

Tor Project APT repository sources.list
== anon-gw-anonymizer-config ==

* https://github.com/Whonix/anon-gw-anonymizer-config
* [https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/debian/control debian/control]
===  Tor Configuration and Tweaks for Anonymity Distributions ===

Tor config file with distribution defaults (for stream isolation, etc.),
example user configurations and other tweaks required. The Tor binary
itself does not get modified.

This package is produced independently of, and carries no guarantee from,
The Tor Project.
=== /usr/share/tor/tor-service-defaults-torrc.anondist ===

* [https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/share/tor/tor-service-defaults-torrc.anondist /usr/share/tor/tor-service-defaults-torrc.anondist]
* <code>~/Whonix/packages/anon-gw-anonymizer-config/usr/share/tor/tor-service-defaults-torrc.anondist</code>
* gateway only<!--gateway-only-->

Whonix Tor configuration

https://www.whonix.org/wiki/Stream_Isolation

* <code>ControlSocket</code>
* <code>SocksPort</code>
* <code>HTTPTunnelPort</code>
* <code>TransPort</code>
* <code>DnsPort</code>
* Upstream Defaults File
* Enable / Disable Tor
* Leak Tests
* General Settings
* Workstation Trans/Dns-Port
* Workstation SocksPorts
* Gateway Trans/Dns-Port
* Gateway SocksPorts
== anon-gw-dhcp-conf ==

* https://github.com/Whonix/anon-gw-dhcp-conf
* [https://github.com/Whonix/anon-gw-dhcp-conf/blob/master/debian/control debian/control]
===  DHCP config for Anonymity Distribution Gateways ===

Prevents DHCP from modifications of /etc/resolv.conf by shipping a
configuration file.

In context of Anonymity Distribution Gateways, it is useful to obtain network
configuration for the interface to connect to the internet from a virtual
machine or hardware router to avoid usability issues with manual static
network configuration. At the same time, Anonymity Distribution Gateways
usually do not need a functional system DNS resolver (/etc/resolv.conf),
pointing to a clearnet DNS resolver, because ideally all the Gateway's traffic
including its own DNS is routed through the anonymity network as well.

Usually the Gateway's firewall should ensure, that the Gateway will not leak
it's own DNS requests. However, preventing DHCP from setting /etc/resolv.conf
to a functional clearnet DNS resolver is useful as defense in depth. Also in
case the Gateways system DNS resolver points to the anonymizer, it is crucial,
that it does not get modified by DHCP.
=== /etc/dhcp/dhclient-enter-hooks.d/nodnsupdate ===

* [https://github.com/Whonix/anon-gw-dhcp-conf/blob/master/etc/dhcp/dhclient-enter-hooks.d/nodnsupdate /etc/dhcp/dhclient-enter-hooks.d/nodnsupdate]
* <code>~/Whonix/packages/anon-gw-dhcp-conf/etc/dhcp/dhclient-enter-hooks.d/nodnsupdate</code>
* gateway only<!--gateway-only-->
* Not installed by default.

prevent resolvconf from modifying <code>/etc/resolv.conf</code>
== anon-gw-dns-conf ==

* https://github.com/Whonix/anon-gw-dns-conf
* [https://github.com/Whonix/anon-gw-dns-conf/blob/master/debian/control debian/control]
===  DNS configuration Anonymity Linux Distribution Gateways ===

Pointing /etc/resolv.conf to 127.0.0.1.

Whether a Anonymity Linux Distribution Gateway supports system DNS for its own
traffic in the clear or anonymized mainly depends on the Gateway's firewall.

Routing the workstation's system DNS through the anonymizer (also known as
Transparent DNS Proxy) or not is up to the Gateway's firewall as well.
=== /etc/resolv.conf.anondist ===

* [https://github.com/Whonix/anon-gw-dns-conf/blob/master/etc/resolv.conf.anondist /etc/resolv.conf.anondist]
* <code>~/Whonix/packages/anon-gw-dns-conf/etc/resolv.conf.anondist</code>
* gateway only<!--gateway-only-->
* Not installed by default.

Configure to use torified DNS server for traffic originating from
Whonix-Gateway.

Set <code>/etc/resolv.conf</code> to <code>nameserver 127.0.0.1</code>
and comments.
=== /lib/systemd/system/systemd-resolved.service.d/40_anon-dns-conf.conf ===

* [https://github.com/Whonix/anon-gw-dns-conf/blob/master/lib/systemd/system/systemd-resolved.service.d/40_anon-dns-conf.conf /lib/systemd/system/systemd-resolved.service.d/40_anon-dns-conf.conf]
* <code>~/Whonix/packages/anon-gw-dns-conf/lib/systemd/system/systemd-resolved.service.d/40_anon-dns-conf.conf</code>
* gateway only<!--gateway-only-->

Disable <code>systemd-resolved</code> if file
<code>/etc/resolv.conf.anondist</code> exists.
== ipv6-disable ==

* https://github.com/Whonix/ipv6-disable
* [https://github.com/Whonix/ipv6-disable/blob/master/debian/control debian/control]
===  Deactivates IPv6 using /etc/sysctl.d/ ===

There are no IPv6 Anonymity Distribution Gateways featuring an IPv6 firewall
yet. Therefore deactivating it to prevent leaks.

For better security.
=== /etc/sysctl.d/ipv6-disable.conf ===

* [https://github.com/Whonix/ipv6-disable/blob/master/etc/sysctl.d/ipv6-disable.conf /etc/sysctl.d/ipv6-disable.conf]
* <code>~/Whonix/packages/ipv6-disable/etc/sysctl.d/ipv6-disable.conf</code>
* gateway only<!--gateway-only-->

disable IPv6
== kicksecure-network-conf ==

* https://github.com/Whonix/kicksecure-network-conf
* [https://github.com/Whonix/kicksecure-network-conf/blob/master/debian/control debian/control]
===  Network Configuration for Kicksecure ===

Sets up external network interfaces eth0 by shipping a configuration file
/etc/network/interfaces.d/30_kicksecure for Kicksecure.

Disables systemd Predictable Network Interface Names.

Configures DNS by shipping a configuration file /etc/resolv.conf for
Kicksecure.

Enables DNSCrypt.
=== /etc/dnscrypt-proxy/kicksecure.toml ===

* [https://github.com/Whonix/kicksecure-network-conf/blob/master/etc/dnscrypt-proxy/kicksecure.toml /etc/dnscrypt-proxy/kicksecure.toml]
* <code>~/Whonix/packages/kicksecure-network-conf/etc/dnscrypt-proxy/kicksecure.toml</code>

DNSCrypt configuration
=== /etc/network/interfaces.d/30_kicksecure ===

* [https://github.com/Whonix/kicksecure-network-conf/blob/master/etc/network/interfaces.d/30_kicksecure /etc/network/interfaces.d/30_kicksecure]
* <code>~/Whonix/packages/kicksecure-network-conf/etc/network/interfaces.d/30_kicksecure</code>

network interfaces configuration eth0
=== /etc/resolv.conf.kicksecure ===

* [https://github.com/Whonix/kicksecure-network-conf/blob/master/etc/resolv.conf.kicksecure /etc/resolv.conf.kicksecure]
* <code>~/Whonix/packages/kicksecure-network-conf/etc/resolv.conf.kicksecure</code>

DNSCrypt configuration
=== /lib/systemd/system/dnscrypt-proxy.service.d/30_kicksecure.conf ===

* [https://github.com/Whonix/kicksecure-network-conf/blob/master/lib/systemd/system/dnscrypt-proxy.service.d/30_kicksecure.conf /lib/systemd/system/dnscrypt-proxy.service.d/30_kicksecure.conf]
* <code>~/Whonix/packages/kicksecure-network-conf/lib/systemd/system/dnscrypt-proxy.service.d/30_kicksecure.conf</code>

Reconfigure DNSCrypt to use configuration file
<code>/etc/dnscrypt-proxy/kicksecure.toml</code> instead of the default
<code>/etc/dnscrypt-proxy/dnscrypt-proxy.toml</code>.

This has the advantage
that no <code>config-package-dev</code> <code>displace</code> is required
and that changes to upstream config file do not conflict with Kicksecure
config file.
== qubes-whonix ==

* https://github.com/Whonix/qubes-whonix
* [https://github.com/Whonix/qubes-whonix/blob/master/debian/control debian/control]
===  Qubes Configuration for Whonix-Gateway and Whonix-Workstation ===

This package contains all the scripts and configuration options to be able
to run Whonix-Gateway and Whonix-Workstation within a Qubes environment.

Whonix-Gateway should run as a ProxyVM.

Whonix-Workstation should run as an AppVM.

Template updates over Tor.

Package: qubes-whonix-shared-packages-recommended
Architecture: all
Depends: qubes-core-agent (<< 4.0.0-1) | qubes-core-agent-passwordless-root,
qubes-kernel-vm-support, initramfs-tools, qubes-mgmt-salt-vm-connector,
qubes-usb-proxy, qubes-input-proxy-sender,
qubes-core-agent-thunar, qubes-core-agent-nautilus,
${misc:Depends}
Description: Recommended packages for Qubes-Whonix-Gateway and Qubes-Whonix-Workstation
===  Recommended packages for Qubes-Whonix-Gateway and Qubes-Whonix-Workstation ===

A metapackage, which includes recommended packages to ensure, Qubes-Whonix
standard tools are available and other useful recommended packages.

Safe to remove, if you know what you are doing.

Package: qubes-whonix-gateway-packages-recommended
Architecture: all
Depends: tinyproxy,
yum,
yum-utils,
qubes-core-agent (<< 4.0.0-1) | qubes-core-agent-dom0-updates,
${misc:Depends}
Description: Recommended packages for Qubes-Whonix-Gateway
===  Recommended packages for Qubes-Whonix-Gateway ===

A metapackage, which installs packages, which are recommended for
Qubes-Whonix-Gateway.

Safe to remove, if you know what you are doing.

Package: qubes-whonix-workstation-packages-recommended
Architecture: all
Depends: qubes-thunderbird,
qubes-gpg-split,
qubes-pdf-converter,
qubes-img-converter,
pulseaudio-qubes | qubes-gui-agent (<< 4.0.0),
${misc:Depends}
Description: Recommended packages for Qubes-Whonix-Workstation
===  Recommended packages for Qubes-Whonix-Workstation ===

A metapackage, which installs packages, which are recommended for
Qubes-Whonix-Workstation.

Feel free to remove, if you know what you are doing.
=== /etc/qubes/protected-files.d/qubes-whonix.conf ===

* [https://github.com/Whonix/qubes-whonix/blob/master/etc/qubes/protected-files.d/qubes-whonix.conf /etc/qubes/protected-files.d/qubes-whonix.conf]
* <code>~/Whonix/packages/qubes-whonix/etc/qubes/protected-files.d/qubes-whonix.conf</code>
* Qubes-Whonix only

Configure Qubes to not modify files shipped by Whonix:

* <code>/etc/hostname</code>
* <code>/etc/hosts</code>
* <code>/etc/localtime</code>
* <code>/etc/timezone</code>
=== /etc/uwt.d/40_qubes.conf ===

* [https://github.com/Whonix/qubes-whonix/blob/master/etc/uwt.d/40_qubes.conf /etc/uwt.d/40_qubes.conf]
* <code>~/Whonix/packages/qubes-whonix/etc/uwt.d/40_qubes.conf</code>
* Qubes-Whonix only

uwt Qubes-Whonix Integration

Runs only inside Qubes TemplateVM.

This configuration snippets configures [[#uwt|uwt]] to wait before running
<code>apt</code> until status file
<code>/run/qubes-service/whonix-secure-proxy</code> or
status file
<code>/run/qubes-service/whonix-secure-proxy-check-done</code>
exists. It will timeout after <code>120</code> seconds.

This is to determine if torified Qubes updates proxy was detected.

If torified Qubes updates proxy detection fails, it will prevent running
<code>apt</code> and show the following warning.

<blockquote>
WARNING: Execution of apt prevented by @file_name@ because no torified Qubes updates proxy found.
</blockquote>

If torified Qubes updates proxy detection succeeds, it will
disable apt uwtwrapper.
In other words, run apt normally. Run apt without <code>torsocks</code>.
Because <code>apt</code> config file.
<code>/etc/apt/apt.conf.d/01qubes-proxy</code> will already have http proxy
settings for TCP based Qubes Updates proxy
<code>Acquire::http::Proxy "http://10.137.255.254:8082/";</code>
or for qrexec based Qubes updates proxy.
<code>Acquire::http::Proxy "http://127.0.0.1:8082/";</code>
== sdwdate ==

* https://github.com/Whonix/sdwdate
* [https://github.com/Whonix/sdwdate/blob/master/debian/control debian/control]
===  Secure Distributed Network Time Synchronization ===

Time keeping is crucial for security, privacy, and anonymity. Sdwdate is a Tor
friendly replacement for rdate and ntpdate that sets the system's clock by
communicating via onion encrypted TCP with Tor onion webservers.

At randomized intervals, sdwdate connects to a variety of webservers and
extracts the time stamps from http headers (RFC 2616).
Using sclockadj option, time is gradually adjusted preventing bigger clock
jumps that could confuse logs, servers, Tor, i2p, etc.

This package contains the sdwdate time fetcher and daemon. No
installation on remote servers required. To avoid conflicts, this daemon
should not be enabled together with ntp or tlsdated.
=== /etc/qubes/suspend-post.d/30_sdwdate.sh ===

* [https://github.com/Whonix/sdwdate/blob/master/etc/qubes/suspend-post.d/30_sdwdate.sh /etc/qubes/suspend-post.d/30_sdwdate.sh]
* <code>~/Whonix/packages/sdwdate/etc/qubes/suspend-post.d/30_sdwdate.sh</code>

hook to run <code>/usr/lib/sdwdate/suspend-post</code>
in Qubes-Whonix.
=== /etc/qubes/suspend-pre.d/30_sdwdate.sh ===

* [https://github.com/Whonix/sdwdate/blob/master/etc/qubes/suspend-pre.d/30_sdwdate.sh /etc/qubes/suspend-pre.d/30_sdwdate.sh]
* <code>~/Whonix/packages/sdwdate/etc/qubes/suspend-pre.d/30_sdwdate.sh</code>

hook to run <code>/usr/lib/sdwdate/suspend-pre</code>
in Qubes-Whonix.
== security-misc ==

* https://github.com/Whonix/security-misc
* [https://github.com/Whonix/security-misc/blob/master/debian/control debian/control]
===  enhances misc security settings ===

Inspired by Kernel Self Protection Project (KSPP)

* Implements most if not all recommended Linux kernel settings (sysctl) and
kernel parameters by KSPP.

* https://kernsec.org/wiki/index.php/Kernel_Self_Protection_Project

kernel hardening:

* deactivates Netfilter's connection tracking helper
Netfilter's connection tracking helper module increases kernel attack
surface by enabling superfluous functionality such as IRC parsing in
the kernel. (!) Hence, this package disables this feature by shipping the
/etc/modprobe.d/30_nf_conntrack_helper_disable.conf configuration file.

* Kernel symbols in various files in /proc are hidden as they can be
very useful for kernel exploits.

* Kexec is disabled as it can be used to load a malicious kernel.
/etc/sysctl.d/kexec.conf

* ASLR effectiveness for mmap is increased.

* The TCP/IP stack is hardened by disabling ICMP redirect acceptance,
ICMP redirect sending and source routing to prevent man-in-the-middle attacks,
ignoring all ICMP requests, enabling TCP syncookies to prevent SYN flood
attacks and enabling RFC1337 to protect against time-wait assassination
attacks.

* Some data spoofing attacks are made harder.

* SACK can be disabled as it is commonly exploited and is rarely used by
uncommenting settings in file /etc/sysctl.d/tcp_sack.conf.

* Slab merging is disabled as sometimes a slab can be used in a vulnerable
way which an attacker can exploit.

* Sanity checks, redzoning, and memory poisoning are enabled.

* Machine checks (MCE) are disabled which makes the kernel panic
on uncorrectable errors in ECC memory that could be exploited.

* Kernel Page Table Isolation is enabled to mitigate Meltdown and increase
KASLR effectiveness.

* SMT is disabled as it can be used to exploit the MDS and other
vulnerabilities.

* All mitigations for the MDS vulnerability are enabled.

* A systemd service clears System.map on boot as these contain kernel symbols
that could be useful to an attacker.
/etc/kernel/postinst.d/30_remove-system-map
/lib/systemd/system/remove-system-map.service
/usr/lib/security-misc/remove-system.map

* Coredumps are disabled as they may contain important information such as
encryption keys or passwords.
/etc/security/limits.d/disable-coredumps.conf
/etc/sysctl.d/coredumps.conf
/lib/systemd/coredump.conf.d/disable-coredumps.conf

* The thunderbolt and firewire kernel modules are blacklisted as they can be
used for DMA (Direct Memory Access) attacks.

* IOMMU is enabled with a boot parameter to prevent DMA attacks.

* The kernel now panics on oopses to prevent it from continuing running a
flawed process.

* Bluetooth is blacklisted to reduce attack surface. Bluetooth also has
a history of security concerns.
https://en.wikipedia.org/wiki/Bluetooth#History_of_security_concerns

* A systemd service restricts /proc/cpuinfo, /proc/bus, /proc/scsi and
/sys to the root user only. This hides a lot of hardware identifiers from
unprivileged users and increases security as /sys exposes a lot of information
that shouldn't be accessible to unprivileged users. As this will break many
things, it is disabled by default and can optionally be enabled by running
`systemctl enable hide-hardware-info.service` as root.

Uncommon network protocols are blacklisted:
These are rarely used and may have unknown vulnerabilities.
/etc/modprobe.d/uncommon-network-protocols.conf
The network protocols that are blacklisted are:

* DCCP - Datagram Congestion Control Protocol
* SCTP - Stream Control Transmission Protocol
* RDS - Reliable Datagram Sockets
* TIPC - Transparent Inter-process Communication
* HDLC - High-Level Data Link Control
* AX25 - Amateur X.25
* NetRom
* X25
* ROSE
* DECnet
* Econet
* af_802154 - IEEE 802.15.4
* IPX - Internetwork Packet Exchange
* AppleTalk
* PSNAP - Subnetwork Access Protocol
* p8023 - Novell raw IEEE 802.3
* p8022 - IEEE 802.2

user restrictions:

* A systemd service mounts /proc with hidepid=2 at boot to prevent users from
seeing each other's processes.

* The kernel logs are restricted to root only.

* The BPF JIT compiler is restricted to the root user and is hardened.

* The ptrace system call is restricted to the root user only.

restricts access to the root account:

* `su` is restricted to only users within the group `sudo` which prevents
users from using `su` to gain root access or to switch user accounts.
/usr/share/pam-configs/wheel-security-misc
(Which results in a change in file `/etc/pam.d/common-auth`.)

* Add user `root` to group `sudo`. This is required to make above work so
login as a user in a virtual console is still possible.
debian/security-misc.postinst

* Abort login for users with locked passwords.
/usr/lib/security-misc/pam-abort-on-locked-password

* Lock user accounts after 100 failed login attempts using pam_tally2.
/usr/share/pam-configs/tally2-security-misc

* Logging into the root account from a virtual, serial, whatnot console is
prevented by shipping an existing and empty /etc/securetty.
(Deletion of /etc/securetty has a different effect.)
/etc/securetty.security-misc

informational output during Linux PAM:

* Show failed and remaining password attempts.
* Document unlock procedure if Linux user account got locked.
* Point out, that there is no password feedback for `su`.
* Explain locked (root) account if locked.
* /usr/share/pam-configs/tally2-security-misc
* /usr/lib/security-misc/pam_tally2-info
* /usr/lib/security-misc/pam-abort-on-locked-password

access rights restrictions:

* Removes read, write and execute access for others for all users who have
home folders under folder /home by running for example
"chmod o-rwx /home/user"
during package installation, upgrade or pam. This will be done only once per
folder in folder /home so users who wish to relax file permissions are free to
do so. This is to protect previously created files in user home folder which
were previously created with lax file permissions prior installation of this
package.
debian/security-misc.postinst
/usr/share/pam-configs/permission-lockdown-security-misc
/usr/lib/security-misc/permission-lockdown

access rights relaxations:

This package does (not yet) automatically lock the root account password.
It is not clear that would be sane in such a package.
It is recommended to lock and expire the root account.
In new Whonix builds, root account will be locked by package
anon-base-files.
https://www.whonix.org/wiki/Root
https://www.whonix.org/wiki/Dev/Permissions
https://forums.whonix.org/t/restrict-root-access/7658
However, a locked root password will break rescue and emergency shell.
Therefore this package enables passwordless resuce and emergency shell.
This is the same solution that Debian will likely addapt for Debian
installer.
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=802211
Adverse security effects can be prevented by setting up BIOS password
protection, grub password protection and/or full disk encryption.
/etc/systemd/system/emergency.service.d/override.conf
/etc/systemd/system/rescue.service.d/override.conf

Disables TCP Time Stamps:

TCP time stamps (RFC 1323) allow for tracking clock
information with millisecond resolution. This may or may not allow an
attacker to learn information about the system clock at such
a resolution, depending on various issues such as network lag.
This information is available to anyone who monitors the network
somewhere between the attacked system and the destination server.
It may allow an attacker to find out how long a given
system has been running, and to distinguish several
systems running behind NAT and using the same IP address. It might
also allow one to look for clocks that match an expected value to find the
public IP used by a user.

Hence, this package disables this feature by shipping the
/etc/sysctl.d/tcp_timestamps.conf configuration file.

Note that TCP time stamps normally have some usefulness. They are
needed for:

* the TCP protection against wrapped sequence numbers; however, to
trigger a wrap, one needs to send roughly 2^32 packets in one
minute:  as said in RFC 1700, "The current recommended default
time to live (TTL) for the Internet Protocol (IP) [45,105] is 64".
So, this probably won't be a practical problem in the context
of Anonymity Distributions.
* "Round-Trip Time Measurement", which is only useful when the user
manages to saturate their connection. When using Anonymity Distributions,
probably the limiting factor for transmission speed is rarely the capacity
of the user connection.

Application specific hardening:

* Enables APT seccomp-BPF sandboxing. /etc/apt/apt.conf.d/40sandbox
* Deactivates previews in Dolphin.
* Deactivates previews in Nautilus.
* Deactivates thumbnails in Thunar.

Discussion:

Happening primarily in Whonix forums.
https://forums.whonix.org/t/kernel-hardening/7296
=== /etc/sysctl.d/tcp_hardening.conf ===

* [https://github.com/Whonix/security-misc/blob/master/etc/sysctl.d/tcp_hardening.conf /etc/sysctl.d/tcp_hardening.conf]
* <code>~/Whonix/packages/security-misc/etc/sysctl.d/tcp_hardening.conf</code>

TCP/IP stack hardening

Protects against time-wait assassination.
It drops RST packets for sockets in the time-wait state.
* <code>net.ipv4.tcp_rfc1337=1</code>

Disables ICMP redirect acceptance.
* <code>net.ipv4.conf.all.accept_redirects=0</code>
* <code>net.ipv4.conf.default.accept_redirects=0</code>
* <code>net.ipv4.conf.all.secure_redirects=0</code>
* <code>net.ipv4.conf.default.secure_redirects=0</code>
* <code>net.ipv6.conf.all.accept_redirects=0</code>
* <code>net.ipv6.conf.default.accept_redirects=0</code>

Disables ICMP redirect sending.
* <code>net.ipv4.conf.all.send_redirects=0</code>
* <code>net.ipv4.conf.default.send_redirects=0</code>

Ignores ICMP requests.
* <code>net.ipv4.icmp_echo_ignore_all=1</code>

Enables TCP syncookies.
* <code>net.ipv4.tcp_syncookies=1</code>

Disable source routing.
* <code>net.ipv4.conf.all.accept_source_route=0</code>
* <code>net.ipv4.conf.default.accept_source_route=0</code>

=== /etc/sysctl.d/tcp_timestamps.conf ===

* [https://github.com/Whonix/security-misc/blob/master/etc/sysctl.d/tcp_timestamps.conf /etc/sysctl.d/tcp_timestamps.conf]
* <code>~/Whonix/packages/security-misc/etc/sysctl.d/tcp_timestamps.conf</code>

disable IPv4 TCP Timestamps

* <code>net.ipv4.tcp_timestamps=0</code>

